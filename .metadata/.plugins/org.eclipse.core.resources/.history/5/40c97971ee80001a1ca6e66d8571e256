import java.io.*;
import java.util.Scanner;

public class Main {

	public static void main(String[] args) throws DuplicatedKeyException {
		Scanner s = new Scanner(System.in);
		String file = "entradaArvore.txt";
		File log = new File("C:\\Temp\\logArvore.txt");
		
		AVLTree arvore = new AVLTree();
		char op;
		String param;
		
		try {
			FileWriter fw = new FileWriter(log.getPath(), false);
			FileReader fr = new FileReader(file);
			BufferedReader in = new BufferedReader(fr);
			BufferedWriter wr = new BufferedWriter(fw);
			String line = in.readLine();
			
			while (line != null) {
				/* Lê comando e parâmetro */
				op = line.charAt(0);
				param = line.substring(1, line.length());
				
				/* Valida o parâmetro e executa o comando correspondente */
				if(validaParam(param)) {
					int intParam = Integer.parseInt(param);
					
					switch(op) {
					/* Insert */
					case 'i':
						try {
							arvore.insert(intParam);
						} catch (DuplicatedKeyException e) {}
						System.out.println("\n" + arvore + "\n\nNúmero de elementos: " + arvore.numElements);
						
						fw.write("Inserindo " + param);
						fw.write("\n");
						fw.write("Número elementos árvore:" + arvore.numElements);
						fw.write("\n");
						break;
					/* Search */
					case 'b':
						System.out.println("\nBuscando o elemento: " + param + " ...");
						System.out.println("Existe " + param + " ? " + arvore.binarySearch(intParam));
						System.out.println("\n" + arvore + "\n\nNúmero de elementos: " + arvore.numElements);
						
						wr.write("Existe " + param + "? " + arvore.binarySearch(intParam));
						fw.write("\n");
						break;
					/* Remove */
					case 'r':
						arvore.remove(intParam);
						
						System.out.println("\nTentando remover o elemento: " + param + " ...");
						System.out.println("\n" + arvore + "\n\nNúmero de elementos: " + arvore.numElements);
						
						wr.write("Removendo " + param);
						fw.write("\n");
						wr.write("Número elementos árvore:" + arvore.numElements);
						fw.write("\n");
						break;
					}					
				}
				
				line = in.readLine();
			}
			in.close();
			fw.close();
		} catch (FileNotFoundException e) {
			System.out.println("Arquivo \""+file+"\" não existe.");
		} catch (IOException e) {
			System.out.println("Erro na leitura de " + file+".");
		}
			
		/* Leitura de valores do teclado para os comandos */
		
		do {
			switch(op.toLowerCase()) {
			case "i":
				System.out.print("Digite o número que deseja inserir: ");
				param = Integer.parseInt(s.nextLine());
				
				try {
					arvore.insert(param);
				} catch (DuplicatedKeyException e) {}
				
				break;
			case "b":
				System.out.print("Digite o número que deseja buscar: ");
				param = Integer.parseInt(s.nextLine());
				
				System.out.println("\nBuscando o elemento: " + param + " ...");
				System.out.println("Existe " + param + " ? " + arvore.binarySearch(param));
				break;
			case "r":	
				System.out.print("Digite o número que deseja remover: ");
				param = Integer.parseInt(s.nextLine());
				
				System.out.println("\nTentando remover o elemento: " + param + " ...");
				arvore.remove(param);
				break;
			default:
				break;	
			}
			System.out.println("\n" + arvore + "\n\nNúmero de elementos: " + arvore.numElements);
			System.out.print("\n+------------+"
						  + "\n+    Menu    +"
						  + "\n- i: inserção"
						  + "\n- b: busca"
						  + "\n- r: remoção"
						  + "\n- s: sair"
						  + "\n: ");
		
			op = s.nextLine();	
			
		} while(!op.toLowerCase().equals("s"));
		
		System.out.println("\nTransformando em ArrayList: " + arvore.toArrayList());
	}
	
	private static boolean validaParam(String param) {
		try {
	        int i = Integer.parseInt(param);
	    } catch (NumberFormatException nfe) {
	        return false;
	    }
		return true;
	}
}

